"use strict";

var INCOME = 60000,
    DEDUCTIBLE = 3000,
    PREMIUM = 400,
    EMPLOYED = true;
$(function () {

  var computeContribution = function computeContribution(d) {
    if (d < 25000) {
      return 0;
    } else if (d >= 25000 && d < 50000) {
      return (d - 25000) * 0.09 / 12;
    } else if (d >= 50000 && d < 75000) {
      return (d - 25000) * 0.11 / 12;
    } else if (d >= 75000 && d < 100000) {
      return (d - 25000) * 0.12 / 12;
    } else if (d >= 100000 && d < 200000) {
      return (d - 25000) * 0.14 / 12;
    } else {
      return (d - 25000) * 0.16 / 12;
    }
  };

  var computeEmployerContrib = function computeEmployerContrib(d) {
    return computeContribution(d) * 0.8;
  };
  //1. Show a bar chart

  //2. Bar chart should have a guide at the top of it

  //3. Have a draggable slider


  var svg = d3.select("svg#chart"),
      margin = { top: 20, right: 40, bottom: 30, left: 20 },
      width = +svg.attr("width") - margin.left - margin.right,
      height = +svg.attr("height") - margin.top - margin.bottom,
      barWidth = 18,
      barGap = 2;

  console.log(svg.attr("width"));
  // SCALES
  var incomeScale = d3.scaleLog().domain([Math.pow(10, 4), 5 * Math.pow(10, 5)]).range([0, width]);
  var contribScale = d3.scaleLinear().domain([0, 6000]).range([height, 0]);

  // AXIS
  var payPoints = [10000, 25000, 50000, 60000, 75000, 100000, 200000, 500000];
  var xAxis = d3.axisBottom(incomeScale).tickValues(payPoints).tickFormat(function (d) {
    return d3.format("$.1s")(d);
  });

  var yAxis = d3.axisRight(contribScale).tickFormat(function (d) {
    return d3.format("$.2s")(d);
  });

  // BARS
  var barCount = width / (barWidth + barGap);
  var dataPoints = [];

  //Get data points
  while (dataPoints.length * (barWidth + barGap) < width) {
    var value = incomeScale.invert(dataPoints.length * (barWidth + barGap));
    dataPoints.push(parseInt(value));
  }

  // console.log("FINAL", dataPoints);

  svg.append("g").attr("class", "y--axis y--axis--monthly").attr("transform", "translate(" + (width + margin.left) + ", " + margin.top + ")").call(yAxis);

  svg.append("g").attr("class", "x--axis x--axis--income").attr("transform", "translate(" + margin.left / 2 + "," + (height + margin.top) + ")").call(xAxis);

  var bars = svg.append("g").attr("transform", "translate(" + margin.left / 2 + "," + margin.top + ")");;

  console.log(dataPoints.map(computeContribution));

  var bars = bars.selectAll(".bar").data(dataPoints).enter().append("g").attr("class", "bar").attr("data-y", function (d) {
    return contribScale(computeContribution(d));
  }).attr("data-val", function (d) {
    return d;
  });

  bars.append("rect").attr("class", "contribution").attr("x", function (d, ind) {
    return ind * (barWidth + barGap);
  }).attr("y", function (d) {
    return contribScale(computeContribution(d));
  }).attr("width", barWidth).attr("height", function (d) {
    return height - contribScale(computeContribution(d) - computeEmployerContrib(d));
  });

  bars.append("rect").attr("class", "employer").attr("x", function (d, ind) {
    return ind * (barWidth + barGap);
  }).attr("y", function (d) {
    return contribScale(computeEmployerContrib(d));
  }).attr("width", barWidth).attr("height", function (d) {
    return height - contribScale(computeEmployerContrib(d));
  });
  // console.log(incomeScale);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJJTkNPTUUiLCJERURVQ1RJQkxFIiwiUFJFTUlVTSIsIkVNUExPWUVEIiwiJCIsImNvbXB1dGVDb250cmlidXRpb24iLCJkIiwiY29tcHV0ZUVtcGxveWVyQ29udHJpYiIsInN2ZyIsImQzIiwic2VsZWN0IiwibWFyZ2luIiwidG9wIiwicmlnaHQiLCJib3R0b20iLCJsZWZ0Iiwid2lkdGgiLCJhdHRyIiwiaGVpZ2h0IiwiYmFyV2lkdGgiLCJiYXJHYXAiLCJjb25zb2xlIiwibG9nIiwiaW5jb21lU2NhbGUiLCJzY2FsZUxvZyIsImRvbWFpbiIsIk1hdGgiLCJwb3ciLCJyYW5nZSIsImNvbnRyaWJTY2FsZSIsInNjYWxlTGluZWFyIiwicGF5UG9pbnRzIiwieEF4aXMiLCJheGlzQm90dG9tIiwidGlja1ZhbHVlcyIsInRpY2tGb3JtYXQiLCJmb3JtYXQiLCJ5QXhpcyIsImF4aXNSaWdodCIsImJhckNvdW50IiwiZGF0YVBvaW50cyIsImxlbmd0aCIsInZhbHVlIiwiaW52ZXJ0IiwicHVzaCIsInBhcnNlSW50IiwiYXBwZW5kIiwiY2FsbCIsImJhcnMiLCJtYXAiLCJzZWxlY3RBbGwiLCJkYXRhIiwiZW50ZXIiLCJpbmQiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTUEsU0FBUyxLQUFmO0FBQUEsSUFDTUMsYUFBYSxJQURuQjtBQUFBLElBRU1DLFVBQVUsR0FGaEI7QUFBQSxJQUdNQyxXQUFXLElBSGpCO0FBSUFDLEVBQUUsWUFBSTs7QUFHSixNQUFNQyxzQkFBc0IsU0FBdEJBLG1CQUFzQixDQUFDQyxDQUFELEVBQU87QUFDakMsUUFBSUEsSUFBSSxLQUFSLEVBQWU7QUFDYixhQUFPLENBQVA7QUFDRCxLQUZELE1BRU8sSUFBSUEsS0FBSSxLQUFKLElBQWFBLElBQUksS0FBckIsRUFBMkI7QUFDaEMsYUFBTyxDQUFDQSxJQUFJLEtBQUwsSUFBYyxJQUFkLEdBQXFCLEVBQTVCO0FBQ0QsS0FGTSxNQUVBLElBQUlBLEtBQUssS0FBTCxJQUFjQSxJQUFJLEtBQXRCLEVBQThCO0FBQ25DLGFBQU8sQ0FBQ0EsSUFBRSxLQUFILElBQVksSUFBWixHQUFtQixFQUExQjtBQUNELEtBRk0sTUFFQSxJQUFLQSxLQUFLLEtBQUwsSUFBY0EsSUFBSSxNQUF2QixFQUErQjtBQUNwQyxhQUFPLENBQUNBLElBQUksS0FBTCxJQUFjLElBQWQsR0FBcUIsRUFBNUI7QUFDRCxLQUZNLE1BRUEsSUFBS0EsS0FBSyxNQUFMLElBQWVBLElBQUksTUFBeEIsRUFBaUM7QUFDdEMsYUFBTyxDQUFDQSxJQUFJLEtBQUwsSUFBYyxJQUFkLEdBQXFCLEVBQTVCO0FBQ0QsS0FGTSxNQUVBO0FBQ0wsYUFBTyxDQUFDQSxJQUFJLEtBQUwsSUFBYyxJQUFkLEdBQXFCLEVBQTVCO0FBQ0Q7QUFDRixHQWREOztBQWdCQSxNQUFNQyx5QkFBeUIsU0FBekJBLHNCQUF5QixDQUFDRCxDQUFELEVBQU87QUFDcEMsV0FBT0Qsb0JBQW9CQyxDQUFwQixJQUF5QixHQUFoQztBQUNELEdBRkQ7QUFHQTs7QUFFQTs7QUFFQTs7O0FBR0EsTUFBSUUsTUFBTUMsR0FBR0MsTUFBSCxDQUFVLFdBQVYsQ0FBVjtBQUFBLE1BQ0lDLFNBQVMsRUFBQ0MsS0FBSyxFQUFOLEVBQVVDLE9BQU8sRUFBakIsRUFBcUJDLFFBQVEsRUFBN0IsRUFBaUNDLE1BQU0sRUFBdkMsRUFEYjtBQUFBLE1BRUlDLFFBQVEsQ0FBQ1IsSUFBSVMsSUFBSixDQUFTLE9BQVQsQ0FBRCxHQUFxQk4sT0FBT0ksSUFBNUIsR0FBbUNKLE9BQU9FLEtBRnREO0FBQUEsTUFHSUssU0FBUyxDQUFDVixJQUFJUyxJQUFKLENBQVMsUUFBVCxDQUFELEdBQXNCTixPQUFPQyxHQUE3QixHQUFtQ0QsT0FBT0csTUFIdkQ7QUFBQSxNQUlJSyxXQUFXLEVBSmY7QUFBQSxNQUtJQyxTQUFTLENBTGI7O0FBT0FDLFVBQVFDLEdBQVIsQ0FBWWQsSUFBSVMsSUFBSixDQUFTLE9BQVQsQ0FBWjtBQUNBO0FBQ0EsTUFBSU0sY0FBY2QsR0FBR2UsUUFBSCxHQUNDQyxNQURELENBQ1EsQ0FBQ0MsS0FBS0MsR0FBTCxDQUFTLEVBQVQsRUFBWSxDQUFaLENBQUQsRUFBaUIsSUFBSUQsS0FBS0MsR0FBTCxDQUFTLEVBQVQsRUFBWSxDQUFaLENBQXJCLENBRFIsRUFFQ0MsS0FGRCxDQUVPLENBQUMsQ0FBRCxFQUFJWixLQUFKLENBRlAsQ0FBbEI7QUFHQSxNQUFJYSxlQUFlcEIsR0FBR3FCLFdBQUgsR0FDSUwsTUFESixDQUNXLENBQUMsQ0FBRCxFQUFJLElBQUosQ0FEWCxFQUVJRyxLQUZKLENBRVUsQ0FBQ1YsTUFBRCxFQUFTLENBQVQsQ0FGVixDQUFuQjs7QUFJQTtBQUNBLE1BQUlhLFlBQVksQ0FBQyxLQUFELEVBQVEsS0FBUixFQUFlLEtBQWYsRUFBc0IsS0FBdEIsRUFBNkIsS0FBN0IsRUFBb0MsTUFBcEMsRUFBNEMsTUFBNUMsRUFBb0QsTUFBcEQsQ0FBaEI7QUFDQSxNQUFJQyxRQUFRdkIsR0FBR3dCLFVBQUgsQ0FBY1YsV0FBZCxFQUNHVyxVQURILENBQ2NILFNBRGQsRUFFR0ksVUFGSCxDQUVjLFVBQUM3QixDQUFEO0FBQUEsV0FBS0csR0FBRzJCLE1BQUgsQ0FBVSxNQUFWLEVBQWtCOUIsQ0FBbEIsQ0FBTDtBQUFBLEdBRmQsQ0FBWjs7QUFJQSxNQUFJK0IsUUFBUTVCLEdBQUc2QixTQUFILENBQWFULFlBQWIsRUFDR00sVUFESCxDQUNjLFVBQUM3QixDQUFEO0FBQUEsV0FBS0csR0FBRzJCLE1BQUgsQ0FBVSxNQUFWLEVBQWtCOUIsQ0FBbEIsQ0FBTDtBQUFBLEdBRGQsQ0FBWjs7QUFHQTtBQUNBLE1BQUlpQyxXQUFXdkIsU0FBT0csV0FBV0MsTUFBbEIsQ0FBZjtBQUNBLE1BQUlvQixhQUFhLEVBQWpCOztBQUVBO0FBQ0EsU0FBT0EsV0FBV0MsTUFBWCxJQUFxQnRCLFdBQVdDLE1BQWhDLElBQTBDSixLQUFqRCxFQUF3RDtBQUN0RCxRQUFJMEIsUUFBUW5CLFlBQVlvQixNQUFaLENBQW1CSCxXQUFXQyxNQUFYLElBQXFCdEIsV0FBV0MsTUFBaEMsQ0FBbkIsQ0FBWjtBQUNBb0IsZUFBV0ksSUFBWCxDQUFnQkMsU0FBU0gsS0FBVCxDQUFoQjtBQUNEOztBQUVEOztBQUVBbEMsTUFBSXNDLE1BQUosQ0FBVyxHQUFYLEVBQ0s3QixJQURMLENBQ1UsT0FEVixFQUNrQiwwQkFEbEIsRUFFS0EsSUFGTCxDQUVVLFdBRlYsa0JBRW9DRCxRQUFRTCxPQUFPSSxJQUZuRCxXQUU0REosT0FBT0MsR0FGbkUsUUFHS21DLElBSEwsQ0FHVVYsS0FIVjs7QUFLQTdCLE1BQUlzQyxNQUFKLENBQVcsR0FBWCxFQUNLN0IsSUFETCxDQUNVLE9BRFYsRUFDa0IseUJBRGxCLEVBRUtBLElBRkwsQ0FFVSxXQUZWLGlCQUVvQ04sT0FBT0ksSUFBUCxHQUFZLENBRmhELFVBRXFERyxTQUFTUCxPQUFPQyxHQUZyRSxTQUdLbUMsSUFITCxDQUdVZixLQUhWOztBQUtBLE1BQUlnQixPQUFPeEMsSUFBSXNDLE1BQUosQ0FBVyxHQUFYLEVBQ0k3QixJQURKLENBQ1MsV0FEVCxFQUNzQixlQUFlTixPQUFPSSxJQUFQLEdBQVksQ0FBM0IsR0FBK0IsR0FBL0IsR0FBcUNKLE9BQU9DLEdBQTVDLEdBQWtELEdBRHhFLENBQVgsQ0FDd0Y7O0FBRXhGUyxVQUFRQyxHQUFSLENBQVlrQixXQUFXUyxHQUFYLENBQWU1QyxtQkFBZixDQUFaOztBQUVBLE1BQUkyQyxPQUFPQSxLQUFLRSxTQUFMLENBQWUsTUFBZixFQUNOQyxJQURNLENBQ0RYLFVBREMsRUFFTlksS0FGTSxHQUdKTixNQUhJLENBR0csR0FISCxFQUlGN0IsSUFKRSxDQUlHLE9BSkgsRUFJWSxLQUpaLEVBS0ZBLElBTEUsQ0FLRyxRQUxILEVBS2EsVUFBQ1gsQ0FBRDtBQUFBLFdBQU11QixhQUFheEIsb0JBQW9CQyxDQUFwQixDQUFiLENBQU47QUFBQSxHQUxiLEVBTUZXLElBTkUsQ0FNRyxVQU5ILEVBTWUsVUFBQ1gsQ0FBRDtBQUFBLFdBQUtBLENBQUw7QUFBQSxHQU5mLENBQVg7O0FBUUkwQyxPQUFLRixNQUFMLENBQVksTUFBWixFQUNHN0IsSUFESCxDQUNRLE9BRFIsRUFDaUIsY0FEakIsRUFFR0EsSUFGSCxDQUVRLEdBRlIsRUFFYSxVQUFDWCxDQUFELEVBQUkrQyxHQUFKO0FBQUEsV0FBWUEsT0FBT2xDLFdBQVdDLE1BQWxCLENBQVo7QUFBQSxHQUZiLEVBR0dILElBSEgsQ0FHUSxHQUhSLEVBR2EsVUFBQ1gsQ0FBRCxFQUFPO0FBQ2hCLFdBQU91QixhQUFheEIsb0JBQW9CQyxDQUFwQixDQUFiLENBQVA7QUFDRCxHQUxILEVBTUdXLElBTkgsQ0FNUSxPQU5SLEVBTWlCRSxRQU5qQixFQU9HRixJQVBILENBT1EsUUFQUixFQU9rQixVQUFDWCxDQUFEO0FBQUEsV0FBT1ksU0FBU1csYUFBYXhCLG9CQUFvQkMsQ0FBcEIsSUFBeUJDLHVCQUF1QkQsQ0FBdkIsQ0FBdEMsQ0FBaEI7QUFBQSxHQVBsQjs7QUFTQTBDLE9BQUtGLE1BQUwsQ0FBWSxNQUFaLEVBQ0c3QixJQURILENBQ1EsT0FEUixFQUNpQixVQURqQixFQUVHQSxJQUZILENBRVEsR0FGUixFQUVhLFVBQUNYLENBQUQsRUFBSStDLEdBQUo7QUFBQSxXQUFZQSxPQUFPbEMsV0FBV0MsTUFBbEIsQ0FBWjtBQUFBLEdBRmIsRUFHR0gsSUFISCxDQUdRLEdBSFIsRUFHYSxVQUFDWCxDQUFELEVBQU87QUFDaEIsV0FBT3VCLGFBQWF0Qix1QkFBdUJELENBQXZCLENBQWIsQ0FBUDtBQUNELEdBTEgsRUFNR1csSUFOSCxDQU1RLE9BTlIsRUFNaUJFLFFBTmpCLEVBT0dGLElBUEgsQ0FPUSxRQVBSLEVBT2tCLFVBQUNYLENBQUQ7QUFBQSxXQUFPWSxTQUFTVyxhQUFhdEIsdUJBQXVCRCxDQUF2QixDQUFiLENBQWhCO0FBQUEsR0FQbEI7QUFRSjtBQUNELENBM0dEIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IElOQ09NRSA9IDYwMDAwLFxuICAgICAgREVEVUNUSUJMRSA9IDMwMDAsXG4gICAgICBQUkVNSVVNID0gNDAwLFxuICAgICAgRU1QTE9ZRUQgPSB0cnVlO1xuJCgoKT0+e1xuXG5cbiAgY29uc3QgY29tcHV0ZUNvbnRyaWJ1dGlvbiA9IChkKSA9PiB7XG4gICAgaWYgKGQgPCAyNTAwMCkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfSBlbHNlIGlmIChkID49MjUwMDAgJiYgZCA8IDUwMDAwKXtcbiAgICAgIHJldHVybiAoZCAtIDI1MDAwKSAqIDAuMDkgLyAxMjtcbiAgICB9IGVsc2UgaWYgKGQgPj0gNTAwMDAgJiYgZCA8IDc1MDAwICkge1xuICAgICAgcmV0dXJuIChkLTI1MDAwKSAqIDAuMTEgLyAxMjtcbiAgICB9IGVsc2UgaWYgKCBkID49IDc1MDAwICYmIGQgPCAxMDAwMDApIHtcbiAgICAgIHJldHVybiAoZCAtIDI1MDAwKSAqIDAuMTIgLyAxMjtcbiAgICB9IGVsc2UgaWYgKCBkID49IDEwMDAwMCAmJiBkIDwgMjAwMDAwICkge1xuICAgICAgcmV0dXJuIChkIC0gMjUwMDApICogMC4xNCAvIDEyO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKGQgLSAyNTAwMCkgKiAwLjE2IC8gMTI7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgY29tcHV0ZUVtcGxveWVyQ29udHJpYiA9IChkKSA9PiB7XG4gICAgcmV0dXJuIGNvbXB1dGVDb250cmlidXRpb24oZCkgKiAwLjg7XG4gIH1cbiAgLy8xLiBTaG93IGEgYmFyIGNoYXJ0XG5cbiAgLy8yLiBCYXIgY2hhcnQgc2hvdWxkIGhhdmUgYSBndWlkZSBhdCB0aGUgdG9wIG9mIGl0XG5cbiAgLy8zLiBIYXZlIGEgZHJhZ2dhYmxlIHNsaWRlclxuXG5cbiAgdmFyIHN2ZyA9IGQzLnNlbGVjdChcInN2ZyNjaGFydFwiKSxcbiAgICAgIG1hcmdpbiA9IHt0b3A6IDIwLCByaWdodDogNDAsIGJvdHRvbTogMzAsIGxlZnQ6IDIwfSxcbiAgICAgIHdpZHRoID0gK3N2Zy5hdHRyKFwid2lkdGhcIikgLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodCxcbiAgICAgIGhlaWdodCA9ICtzdmcuYXR0cihcImhlaWdodFwiKSAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tLFxuICAgICAgYmFyV2lkdGggPSAxOCxcbiAgICAgIGJhckdhcCA9IDI7XG5cbiAgY29uc29sZS5sb2coc3ZnLmF0dHIoXCJ3aWR0aFwiKSk7XG4gIC8vIFNDQUxFU1xuICB2YXIgaW5jb21lU2NhbGUgPSBkMy5zY2FsZUxvZygpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oW01hdGgucG93KDEwLDQpLCA1ICogTWF0aC5wb3coMTAsNSldKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSk7XG4gIHZhciBjb250cmliU2NhbGUgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZG9tYWluKFswLCA2MDAwXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XG5cbiAgLy8gQVhJU1xuICB2YXIgcGF5UG9pbnRzID0gWzEwMDAwLCAyNTAwMCwgNTAwMDAsIDYwMDAwLCA3NTAwMCwgMTAwMDAwLCAyMDAwMDAsIDUwMDAwMF07XG4gIHZhciB4QXhpcyA9IGQzLmF4aXNCb3R0b20oaW5jb21lU2NhbGUpXG4gICAgICAgICAgICAgICAgLnRpY2tWYWx1ZXMocGF5UG9pbnRzKVxuICAgICAgICAgICAgICAgIC50aWNrRm9ybWF0KChkKT0+ZDMuZm9ybWF0KFwiJC4xc1wiKShkKSk7XG5cbiAgdmFyIHlBeGlzID0gZDMuYXhpc1JpZ2h0KGNvbnRyaWJTY2FsZSlcbiAgICAgICAgICAgICAgICAudGlja0Zvcm1hdCgoZCk9PmQzLmZvcm1hdChcIiQuMnNcIikoZCkpXG5cbiAgLy8gQkFSU1xuICB2YXIgYmFyQ291bnQgPSB3aWR0aC8oYmFyV2lkdGggKyBiYXJHYXApO1xuICB2YXIgZGF0YVBvaW50cyA9IFtdO1xuXG4gIC8vR2V0IGRhdGEgcG9pbnRzXG4gIHdoaWxlIChkYXRhUG9pbnRzLmxlbmd0aCAqIChiYXJXaWR0aCArIGJhckdhcCkgPCB3aWR0aCkge1xuICAgIHZhciB2YWx1ZSA9IGluY29tZVNjYWxlLmludmVydChkYXRhUG9pbnRzLmxlbmd0aCAqIChiYXJXaWR0aCArIGJhckdhcCkpO1xuICAgIGRhdGFQb2ludHMucHVzaChwYXJzZUludCh2YWx1ZSkpO1xuICB9XG5cbiAgLy8gY29uc29sZS5sb2coXCJGSU5BTFwiLCBkYXRhUG9pbnRzKTtcblxuICBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLFwieS0tYXhpcyB5LS1heGlzLS1tb250aGx5XCIpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7d2lkdGggKyBtYXJnaW4ubGVmdH0sICR7bWFyZ2luLnRvcH0pYClcbiAgICAgIC5jYWxsKHlBeGlzKTtcblxuICBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLFwieC0tYXhpcyB4LS1heGlzLS1pbmNvbWVcIilcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdC8yfSwke2hlaWdodCArIG1hcmdpbi50b3B9KWApXG4gICAgICAuY2FsbCh4QXhpcyk7XG5cbiAgdmFyIGJhcnMgPSBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgbWFyZ2luLmxlZnQvMiArIFwiLFwiICsgbWFyZ2luLnRvcCArIFwiKVwiKTs7XG5cbiAgY29uc29sZS5sb2coZGF0YVBvaW50cy5tYXAoY29tcHV0ZUNvbnRyaWJ1dGlvbikpO1xuXG4gIHZhciBiYXJzID0gYmFycy5zZWxlY3RBbGwoXCIuYmFyXCIpXG4gICAgICAuZGF0YShkYXRhUG9pbnRzKVxuICAgICAgLmVudGVyKClcbiAgICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiYmFyXCIpXG4gICAgICAgICAgLmF0dHIoXCJkYXRhLXlcIiwgKGQpPT4gY29udHJpYlNjYWxlKGNvbXB1dGVDb250cmlidXRpb24oZCkpKVxuICAgICAgICAgIC5hdHRyKFwiZGF0YS12YWxcIiwgKGQpPT5kKTtcblxuICAgICAgYmFycy5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjb250cmlidXRpb25cIilcbiAgICAgICAgLmF0dHIoXCJ4XCIsIChkLCBpbmQpID0+IGluZCAqIChiYXJXaWR0aCArIGJhckdhcCkpXG4gICAgICAgIC5hdHRyKFwieVwiLCAoZCkgPT4ge1xuICAgICAgICAgIHJldHVybiBjb250cmliU2NhbGUoY29tcHV0ZUNvbnRyaWJ1dGlvbihkKSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5hdHRyKFwid2lkdGhcIiwgYmFyV2lkdGgpXG4gICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIChkKSA9PiBoZWlnaHQgLSBjb250cmliU2NhbGUoY29tcHV0ZUNvbnRyaWJ1dGlvbihkKSAtIGNvbXB1dGVFbXBsb3llckNvbnRyaWIoZCkpKVxuXG4gICAgICBiYXJzLmFwcGVuZChcInJlY3RcIilcbiAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImVtcGxveWVyXCIpXG4gICAgICAgIC5hdHRyKFwieFwiLCAoZCwgaW5kKSA9PiBpbmQgKiAoYmFyV2lkdGggKyBiYXJHYXApKVxuICAgICAgICAuYXR0cihcInlcIiwgKGQpID0+IHtcbiAgICAgICAgICByZXR1cm4gY29udHJpYlNjYWxlKGNvbXB1dGVFbXBsb3llckNvbnRyaWIoZCkpO1xuICAgICAgICB9KVxuICAgICAgICAuYXR0cihcIndpZHRoXCIsIGJhcldpZHRoKVxuICAgICAgICAuYXR0cihcImhlaWdodFwiLCAoZCkgPT4gaGVpZ2h0IC0gY29udHJpYlNjYWxlKGNvbXB1dGVFbXBsb3llckNvbnRyaWIoZCkpKVxuICAvLyBjb25zb2xlLmxvZyhpbmNvbWVTY2FsZSk7XG59KTtcbiJdfQ==
